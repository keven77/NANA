{
  "populateCatalog": [
    {
      "tableName": "solrtemp1.TI_CGCATALOG_0",
      "createSQL": "CREATE TABLE solrtemp1.TI_CGCATALOG_0 (CATGROUP_KEY BIGINT NOT NULL, CATALOG VARCHAR(256), PRIMARY KEY (CATGROUP_KEY));",
      "querySQL": "SELECT C_TOPR_R.CATGROUP_KEY,GROUP_CONCAT(C_TOPR_R.CATALOG SEPARATOR ';') AS CATALOG FROM (SELECT TOPR.CATGROUP_KEY CATGROUP_KEY, TOPR.CATALOG_KEY AS CATALOG FROM mdmdb2.catgroup C JOIN mdmdb2.cattogrp TOPR ON TOPR.CATGROUP_KEY = C.CATGROUP_KEY WHERE C.ISDELETE=0 UNION SELECT R.CATGROUP_KEY_CHILD CATGROUP_KEY, R.CATALOG_KEY AS CATALOG FROM mdmdb2.catgroup C JOIN mdmdb2.catgrprel R ON R.CATGROUP_KEY_CHILD = C.CATGROUP_KEY WHERE  C.ISDELETE=0) C_TOPR_R GROUP BY C_TOPR_R.CATGROUP_KEY ORDER BY C_TOPR_R.CATGROUP_KEY;"
    },
    {
      "tableName": "solrtemp1.TI_CATGRPREL_0",
      "createSQL": "CREATE TABLE solrtemp1.TI_CATGRPREL_0 (CATGROUP_KEY BIGINT NOT NULL, SEQUENCE VARCHAR(10240), PRIMARY KEY (CATGROUP_KEY));",
      "querySQL": "SELECT CG_CATGRPREL_CATTOGRP.CATGROUP_KEY,COALESCE(CG_CATGRPREL_CATTOGRP.SEQUENCE,0) AS SEQUENCE FROM(SELECT CATGRPREL.CATGROUP_KEY_CHILD CATGROUP_KEY, CATGRPREL.SEQUENCE SEQUENCE FROM solrtemp1.TI_CGCATALOG_0 CG JOIN mdmdb2.catgrprel CATGRPREL ON CATGRPREL.CATGROUP_KEY_CHILD=CG.CATGROUP_KEY UNION SELECT CATTOGRP.CATGROUP_KEY CATGROUP_KEY, CATTOGRP.SEQUENCE SEQUENCE FROM solrtemp1.TI_CGCATALOG_0 CG JOIN mdmdb2.cattogrp CATTOGRP ON CATTOGRP.CATGROUP_KEY=CG.CATGROUP_KEY) CG_CATGRPREL_CATTOGRP GROUP BY CG_CATGRPREL_CATTOGRP.CATGROUP_KEY;"
    },
    {
      "tableName": "solrtemp1.TI_DPGROUP_0",
      "createSQL": "CREATE TABLE solrtemp1.TI_DPGROUP_0 (CATGROUP_KEY BIGINT NOT NULL, CATGROUP VARCHAR(10240), PRIMARY KEY (CATGROUP_KEY));",
      "querySQL": "SELECT CG_CATGRPREL_CATTOGRP.CATGROUP_KEY ,GROUP_CONCAT(CG_CATGRPREL_CATTOGRP.CATGROUP SEPARATOR ';') AS CATGROUP FROM(SELECT CATGRPREL.CATGROUP_KEY_CHILD CATGROUP_KEY, concat_ws('_',CATGRPREL.CATALOG_KEY, CATGRPREL.CATGROUP_KEY_PARENT) CATGROUP FROM solrtemp1.TI_CGCATALOG_0 CG JOIN mdmdb2.catgrprel CATGRPREL ON CATGRPREL.CATGROUP_KEY_CHILD=CG.CATGROUP_KEY UNION SELECT CATTOGRP.CATGROUP_KEY CATGROUP_KEY, concat(CATTOGRP.CATALOG_KEY,'_-1') CATGROUP FROM solrtemp1.TI_CGCATALOG_0 CG JOIN mdmdb2.cattogrp CATTOGRP ON CATTOGRP.CATGROUP_KEY=CG.CATGROUP_KEY)CG_CATGRPREL_CATTOGRP GROUP BY CG_CATGRPREL_CATTOGRP.CATGROUP_KEY ORDER BY CG_CATGRPREL_CATTOGRP.CATGROUP_KEY;"
    },
    {
      "tableName": "solrtemp1.TI_DCCATGRP_0",
      "createSQL": "CREATE TABLE solrtemp1.TI_DCCATGRP_0 (CATGROUP_KEY BIGINT NOT NULL, DCCATGRP VARCHAR(20480), PRIMARY KEY (CATGROUP_KEY));",
      "querySQL": "SELECT CATGRPREL.CATGROUP_KEY_PARENT CATGROUP_KEY, GROUP_CONCAT(concat_ws('_',CATGRPREL.CATALOG_KEY,CATGRPREL.CATGROUP_KEY_CHILD) SEPARATOR ';') AS DCCATGRP FROM solrtemp1.TI_CGCATALOG_0 CG JOIN mdmdb2.catgrprel CATGRPREL ON CATGRPREL.CATGROUP_KEY_PARENT=CG.CATGROUP_KEY GROUP BY CG.CATGROUP_KEY ORDER BY CATGRPREL.CATGROUP_KEY_PARENT, CATGRPREL.CATALOG_KEY, CATGRPREL.SEQUENCE, CATGRPREL.CATGROUP_KEY_CHILD;"
    },
    {
      "tableName": "solrtemp1.TI_CATGRP_0",
      "createSQL": "CREATE TABLE solrtemp1.TI_CATGRP_0 (CATGROUP_KEY BIGINT NOT NULL, CATALOGGROUP VARCHAR(10240), PRIMARY KEY (CATGROUP_KEY));",
      "querySQL": "SELECT TI_CATGRPREL_CATTOGRP.CATGROUP_KEY,GROUP_CONCAT(TI_CATGRPREL_CATTOGRP.CATALOGGROUP SEPARATOR ';') AS CATALOGGROUP FROM (SELECT CATGRPREL.CATGROUP_KEY_CHILD CATGROUP_KEY, concat_ws('_',CATGRPREL.CATALOG_KEY,CATGRPREL.CATGROUP_KEY_CHILD) CATALOGGROUP FROM solrtemp1.TI_CGCATALOG_0 TI JOIN mdmdb2.catgrprel CATGRPREL ON CATGRPREL.CATGROUP_KEY_CHILD=TI.CATGROUP_KEY UNION SELECT CATTOGRP.CATGROUP_KEY CATGROUP_KEY, concat_ws('_',CATTOGRP.CATALOG_KEY,CATTOGRP.CATGROUP_KEY) CATALOGGROUP FROM solrtemp1.TI_CGCATALOG_0 TI JOIN mdmdb2.cattogrp CATTOGRP ON CATTOGRP.CATGROUP_KEY=TI.CATGROUP_KEY )TI_CATGRPREL_CATTOGRP GROUP BY TI_CATGRPREL_CATTOGRP.CATGROUP_KEY ORDER BY TI_CATGRPREL_CATTOGRP.CATGROUP_KEY;"
    }
  ]
}
